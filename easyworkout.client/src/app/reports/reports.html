<h2>Reports</h2>

<form [formGroup]="form" (ngSubmit)="submit()">
    <mat-form-field>
        <mat-label>Chart type</mat-label>
        <mat-select matInput title="Chart type" placeholder="Chart type" formControlName="chartType">
            <mat-option value="totalVolume">Total Volume</mat-option>
            <mat-option value="totalTime">Total Time</mat-option>
            <mat-option value="totalDistance">Total Distance</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>Start date (optional)</mat-label>
        <input matInput [matDatepicker]="fromPicker" title="From date" placeholder="From date" formControlName="fromDate">
        <mat-hint>MM/DD/YYYY</mat-hint>
        <mat-datepicker-toggle matIconSuffix [for]="fromPicker"></mat-datepicker-toggle>
        <mat-datepicker #fromPicker></mat-datepicker>
    </mat-form-field>
    <mat-form-field>
        <mat-label>End date (optional)</mat-label>
        <input matInput [matDatepicker]="toPicker" title="To date" placeholder="To date" formControlName="toDate">
        <mat-hint>MM/DD/YYYY</mat-hint>
        <mat-datepicker-toggle matIconSuffix [for]="toPicker"></mat-datepicker-toggle>
        <mat-datepicker #toPicker></mat-datepicker>
    </mat-form-field>
    <mat-form-field>
        <mat-label>Workout (optional)</mat-label>
        <mat-select matInput title="Workout" placeholer="Workout" formControlName="workoutId">
            @for (workout of workoutTemplates; track $index) {
                <mat-option [value]="workout.id">{{ workout.name }}</mat-option>
            }
        </mat-select>
    </mat-form-field>
    @if (this.form.value.chartType == 'totalVolume') {
        <mat-form-field>
            <mat-label>Weight unit</mat-label>
            <mat-select matInput title="Weight unit" placeholder="Weight unit" formControlName="weightUnit">
                @for (weightUnit of weightUnitOptions; track $index) {
                    <mat-option [value]="weightUnit">{{weightUnit}}</mat-option>
                }
            </mat-select>
        </mat-form-field>
    }
    @if (this.form.value.chartType == 'totalTime') {
        <mat-form-field>
            <mat-label>Time unit</mat-label>
            <mat-select matInput title="Time unit" placeholder="Time unit" formControlName="durationUnit">
                @for (durationUnit of durationUnitOptions; track $index) {
                    <mat-option [value]="durationUnit">{{durationUnit}}</mat-option>
                }
            </mat-select>
        </mat-form-field>
    }
    @if (this.form.value.chartType == 'totalDistance') {
        <mat-form-field>
            <mat-label>Distance unit</mat-label>
            <mat-select matInput title="Distance unit" placeholder="Distance unit" formControlName="distanceUnit">
                @for (distanceUnit of distanceUnitOptions; track $index) {
                    <mat-option [value]="distanceUnit">{{distanceUnit}}</mat-option>
                }
            </mat-select>
        </mat-form-field>
    }
    <button matButton="filled" type="submit">Generate chart</button>
</form>

@if (isChartLoaded()) {
    <div style="display: block; width: 600px;">
        <canvas baseChart
            [options]="lineChartOptions"
            [data]="lineChartData"
            [type]="lineChartType"
            [legend]="lineChartLegend">
        </canvas>
    </div>
}